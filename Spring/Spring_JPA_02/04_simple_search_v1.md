## 간단한 주문 조회: V1 엔티티를 직접 노출

API 개발 고급 - 지연 로딩과 조회 성능 최적화 주문 + 배송정보 + 회원을 조회하는 API를 만들자
지연 로딩 때문에 발생하는 성능 문제를 단계적으로 해결해보자.
> 참고: 지금부터 설명하는 내용은 정말 중요합니다. 실무에서 JPA를 사용하려면 100% 이해해야 합니다.
> 안그러면 엄청난 시간을 날리고 강사를 원망하면서 인생을 허비하게 됩니다.

!! 엔티티를 직접 노출하는 것은 좋지 않다. (앞장에서 이미 설명)
- order member 와 order address 는 지연 로딩이다.
- 따라서 실제 엔티티 대신에 프록시 존재
- jackson 라이브러리는 기본적으로 이 프록시 객체를 json으로 어떻게 생성해야 하는지 모름 
- Hibernate5Module 을 스프링 빈으로 등록하면 해결(스프링 부트 사용중)
- 
  주의: 엔티티를 직접 노출할 때는 양방향 연관관계가 걸린 곳은 꼭! 한곳을 @JsonIgnore 처리 해야 한다. 
- 안그러면 양쪽을 서로 호출하면서 무한 루프가 걸린다.
- API에 Entity를 직접 보내면, 해당 Entity를 수정 할때마다 front도 다 바꾸어줘야함.

> 참고: 앞에서 계속 강조했듯이 정말 간단한 애플리케이션이 아니면 엔티티를 API 응답으로 외부로 노출하는 것은 좋지 않다. 따라서 Hibernate5Module 를 사용하기 보다는 DTO로 변환해서 반환하는 것이 더 좋은 방법이다.
> 주의: 지연 로딩(LAZY)을 피하기 위해 즉시 로딩(EARGR)으로 설정하면 안된다! 즉시 로딩 때문에 연관관계가 필요 없는 경우에도 데이터를 항상 조회해서 성능 문제가 발생할 수 있다. 즉시 로딩으로 설정하면 성능 튜닝이 매우 어려워 진다.
> 항상 지연 로딩을 기본으로 하고, 성능 최적화가 필요한 경우에는 페치 조인(fetch join)을 사용해라!(V3 에서 설명)

 
