## 상품 주문 서비스 개발
### 새로운 엔티티 저장과 준영속 엔티티 병합을 편리하게 한번에 처리
- 상품 리포지토리에선 save() 메서드를 유심히 봐야 하는데, 이 메서드 하나로 저장과 수정(병합)을 다 처리한다. 
- 코드를 보면 식별자 값이 없으면 새로운 엔티티로 판단해서 persist() 로 영속화하고 만약 식별자 값이 있으면 
- 이미 한번 영속화 되었던 엔티티로 판단해서 merge() 로 수정(병합)한다. 
- 결국 여기서의 저장 (save)이라는 의미는 신규 데이터를 저장하는 것뿐만 아니라 변경된 데이터의 저장이라는 의미도 포함한다.
- 이렇게 함으로써 이 메서드를 사용하는 클라이언트는 저장과 수정을 구분하지 않아도 되므로 클라이언트의 로직이 단순해진다. 
- 여기서 사용하는 수정(병합)은 준영속 상태의 엔티티를 수정할 때 사용한다.
- 영속 상태의 엔티티는 변경 감 지(dirty checking)기능이 동작해서 트랜잭션을 커밋할 때 자동으로 수정되므로 별도의 수정 메서드를 호출할 필요가 없고 그런 메서드도 없다.
### 가장 좋은 해결 방법
  - 엔티티를 변경할 때는 항상 변경 감지를 사용하세요
  - 컨트롤러에서 어설프게 엔티티를 생성하지 마세요.
  - 트랜잭션이 있는 서비스 계층에 식별자( id )와 변경할 데이터를 명확하게 전달하세요.
    - (파라미터 or dto) 트랜잭션이 있는 서비스 계층에서 영속 상태의 엔티티를 조회하고, 엔티티의 데이터를 직접 변경하세요. 트랜잭션 커밋 시점에 변경 감지가 실행됩니다.
